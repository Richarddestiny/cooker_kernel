/*
 * Copyright 2021 Cooker Devices
 */

#include "myb-imx8mm-base.dts"

/{
     display-subsystem {                                                                                
         status = "okay";
	};
    
        mipi_backlight0: mipi_backlight@0 {
                compatible = "pwm-backlight";
                pwms = <&pwm1 0 1000000 >; /*1KHZ*/
                enable-gpios = <&gpio1 8 GPIO_ACTIVE_HIGH>; 
                brightness-levels = < 0  1  2  3  4  5  6  7  8  9
                                10 11 12 13 14 15 16 17 18 19
                                20 21 22 23 24 25 26 27 28 29
                                30 31 32 33 34 35 36 37 38 39
                                40 41 42 43 44 45 46 47 48 49
                                50 51 52 53 54 55 56 57 58 59
                                60 61 62 63 64 65 66 67 68 69
                                70 71 72 73 74 75 76 77 78 79
                                80 81 82 83 84 85 86 87 88 89
                                90 91 92 93 94 95 96 97 98 99
                                100>;
                default-brightness-level = <100>;
        };
};

&lcdif{
	max-res = <800>, <1280>;
	status = "okay";
};

&iomuxc {
	imx8mm-evk {
		pinctrl_pwm1: mipi0pwm1grp {
			fsl,pins = <
				MX8MM_IOMUXC_GPIO1_IO01_PWM1_OUT 0x19
			>;
		};
               
	        pinctrl_wm8904_amp: wm8904_amp {
			fsl,pins = <
				MX8MM_IOMUXC_SAI5_RXD2_GPIO3_IO23       0x19
			>;
		};
	};

};

&pwm1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_pwm1>;
	status = "okay";
};

&iomuxc {
	imx8mm-evk {
                ilitek_ili2131_pins:pinctrl_ili2131grp {
                        fsl,pins = <
                                MX8MM_IOMUXC_GPIO1_IO12_GPIO1_IO12   0x19  //reset pin
                                MX8MM_IOMUXC_SAI1_RXC_GPIO4_IO1      0x19  //interrupt pin
                        
                        >;
                };
                
                pinctrl_mipi_dsi_en: mipi_dsi_en {
		fsl,pins = <
			MX8MM_IOMUXC_SAI2_MCLK_GPIO4_IO27  0x19        0x00000116 //reset
		>;
	};
	};
};

/* touch */
&i2c3 {
        clock_frequency = <400000>;
        pinctrl-names = "default";
        status = "okay";
     //   pinctrl-1 = <&ilitek_ili2131_pins>;
     
        //  ili2131: ili2131@38 { 
        // compatible = " ilitek,ili210x"; 
        // reg = <0x38>; 
        // interrupt-parent = <&gpio4>; 
        // interrupts = <1 0x0>; 
        // irq-gpio = <&gpio4 1 0x0>; 
        // reset-gpio = <&gpio1 12 0x0>;   
     
        // }; 


         ili2131: ili2131@41 { 
        compatible = "tchip,ilitek"; 
        reg = <0x41>; 
        pinctrl-names = "default";
        pinctrl-0 = <&ilitek_ili2131_pins>;

        interrupt-parent = <&gpio4>; 
        interrupts = <1 IRQ_TYPE_EDGE_FALLING>; 
        ilitek,irq-gpio = <&gpio4 1 IRQ_TYPE_EDGE_FALLING>; 
        ilitek,reset-gpio = <&gpio1 12 GPIO_ACTIVE_HIGH>; 
        // ilitek,vbus = "vcc_i2c"; 
        // ilitek,vdd = "vdd"; 
        ilitek,name = "ilitek_i2c"; 
        }; 

//       ili2131: ili2131@41 {  
//                 pinctrl-names = "default";
//                 compatible = "ilitek,ili213x"; 
//                  pinctrl-0 = <&ilitek_ili2131_pins>;
//                 reg = <0x41>; 
//                 interrupt-parent = <&gpio4>; 
//                 interrupts = <1 IRQ_TYPE_EDGE_FALLING>; 
//                 reset-gpios = <&gpio1 12 GPIO_ACTIVE_HIGH>;

//         //         touchscreen-min-x = <0>;
//         //         touchscreen-size-x = <800>;
//         //         touchscreen-fuzz-x = <800>;

//         //         touchscreen-min-y = <0>;
//         //         touchscreen-size-y = <1280>;
//         //        touchscreen-fuzz-y = <1280>;
//          }; 


        // ft5x06: ft5x06@38 {
	//         compatible = "edt,edt-ft5406", "edt,edt-ft5x06";
        //         reg = <0x38>;
        //         pinctrl-names = "default";
        //         pinctrl-0 = <&ilitek_ili2131_pins>;
        //         interrupt-parent = <&gpio4>;
        //         interrupts = <1 IRQ_TYPE_EDGE_FALLING>;
        //         reset-gpios = <&gpio1 12  GPIO_ACTIVE_LOW>;
	//         touchscreen-size-x=<1024>;
	//         touchscreen-size-y=<600>;
        // };

};

// &i2c2 {
//         tc358775:tc358775@f{
//                 compatible = "toshiba,tc358775";
//                 reg  = <0x0f>;
//               //  status = "okay";
//                 status = "disable";
//         };
// };


&mipi_dsi {
	status = "okay";

	panel@0 {
	compatible = "yeebo,ili9881c";
	reg = <0>;
	backlight = <&mipi_backlight0>;
        };
};
